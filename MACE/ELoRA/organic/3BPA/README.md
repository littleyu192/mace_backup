## 3BPA

## 数据集

https://github.com/davkovacs/BOTNet-datasets

## 相关文献

https://doi.org/10.1021/acs.jctc.1c00647

https://arxiv.org/abs/2205.06643 

## 训练

训练仅在 300K 的数据集中进行，测试集包括 300K 600K 1200K dih（二面角扫描）。

baseline/ 是从头训练，finetune/ 是全参数微调，LoRA/ 是 ELoRA 微调。

编号代表随机数种子。

## 测试

### 精度

使用训练好的模型在测试集上进行 Energy 和 Force 的计算，然后统计测试集上的误差。

推理和统计相关文件在 [scripts](../../scripts/) 中。

使用 [test.py](./test.py) 计算三次运行的均值和方差。

**Root-mean-square errors of energy (E, meV) and force (F, meV/Å) on the 3BPA dataset.** 

|          |   Allegro    |   NequIP   |   BOTNet    |     PACE      |    MACE    | MACE (Full-parameter) |  MACE (ELoRA)   | MACE (OFF23) |
| :------: | :----------: | :--------: | :---------: | :-----------: | :--------: | :-------------------: | :-------------: | :----------: |
| 300K,  E | 3.84 (0.08)  | 3.3 (0.1)  | 3.1 (0.13)  | **2.4 (0.1)** | 3.0 (0.2)  |      3.3 (0.03)       |   3.0 (0.05)    |   17340.0    |
| 300K,  F | 12.98 (0.17) | 10.8 (0.2) | 11.0 (0.14) |   9.1 (0.1)   | 8.8 (0.3)  |      7.8 (0.01)       | **7.5 (0.05)**  |    124.7     |
| 600K,  E | 12.07 (0.45) | 11.2 (0.1) | 11.5 (0.6)  |   7.9 (0.2)   | 9.7 (0.5)  |      7.3 (0.04)       | **6.5 (0.10)**  |   17369.8    |
| 600K,  F | 29.17 (0.22) | 26.4 (0.1) | 26.7 (0.29) |  21.4 (0.3)   | 21.8 (0.6) |      16.6 (0.05)      | **15.5 (0.12)** |    136.1     |
| 1200K, E | 42.57 (1.46) | 38.5 (1.6) | 39.1 (1.1)  |  29.6 (0.4)   | 29.8 (1.0) |      20.3 (0.17)      | **17.6 (0.11)** |   17412.8    |
| 1200K, F | 82.96 (1.77) | 76.2 (1.1) | 81.1 (1.5)  |  60.7 (2.0)   | 62.0 (0.7) |      48.7 (0.56)      | **42.0 (0.51)** |    157.3     |
| dih,   E |              |     -      | 16.3 (1.5)  |   7.6 (0.4)   | 7.8 (0.6)  |      7.3 (0.28)       | **5.9 (0.28)**  |   17309.4    |
| dih,   F |              |     -      | 20.0 (1.2)  |  16.0 (0.5)   | 16.5 (1.7) |      12.3 (0.10)      | **11.4 (0.17)** |    116.2     |

### 二面角

使用 [dihedral.py](./dihedral.py) 绘制二面角切片能量

![dihedral.pdf](dihedral.pdf)